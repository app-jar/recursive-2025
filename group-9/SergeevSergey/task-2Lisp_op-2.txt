 
;; 2. Отсортировать список чисел по возрастанию

(defun quick-sort (lst)
  "Быстрая сортировка списка чисел"
  (cond
    ((null lst) nil)  ;; Пустой список уже отсортирован
    (t
     (let ((pivot (car lst))
           (tail (cdr lst)))
       ;; Рекурсивно сортируем элементы меньше и больше опорного
       (append 
        (quick-sort (remove-if-not (lambda (x) (<= x pivot)) tail))
        (list pivot)
        (quick-sort (remove-if (lambda (x) (<= x pivot)) tail)))))))

(defun bubble-sort (lst)
  "Сортировка пузырьком"
  (if (null lst)
      nil
      (let ((sorted-pair (bubble-pass lst)))
        (cons (car sorted-pair) 
              (bubble-sort (cdr sorted-pair))))))

(defun bubble-pass (lst)
  "Один проход пузырьковой сортировки"
  (cond
    ((null (cdr lst)) lst)  ;; Один элемент уже отсортирован
    ((> (car lst) (cadr lst)) 
     (cons (cadr lst) (bubble-pass (cons (car lst) (cddr lst)))))
    (t 
     (cons (car lst) (bubble-pass (cdr lst))))))

(defun insertion-sort (lst)
  "Сортировка вставками"
  (reduce (lambda (item sorted)
            (insert item sorted))
          lst
          :initial-value nil))

(defun insert (item lst)
  "Вставка элемента в отсортированный список"
  (cond
    ((null lst) (list item))
    ((<= item (car lst)) (cons item lst))
    (t (cons (car lst) (insert item (cdr lst))))))

;; Основная функция сортировки (можно выбрать любой алгоритм)
(defun sort-list (lst)
  "Отсортировать список чисел по возрастанию"
  (quick-sort lst))

;; Функция с подробным выводом процесса (в стиле лабораторной работы)
(defun print-sorted-list (lst)
  "Вывод исходного и отсортированного списка"
  (format t "~%Исходный список: ~a~%" lst)
  (let ((sorted (sort-list lst)))
    (format t "Отсортированный список: ~a~%" sorted)
    sorted))

;; Альтернативная версия с использованием встроенной функции
(defun builtin-sort (lst)
  "Сортировка с использованием встроенной функции"
  (sort lst #'<))

;; Примеры использования:
(print-sorted-list '(3 1 4 1 5 9 2 6))
(print-sorted-list '(5 2 8 1 9))
(print-sorted-list '())
(print-sorted-list '(5))
(print-sorted-list '(9 8 7 6 5 4 3 2 1))